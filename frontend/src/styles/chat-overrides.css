/* chat-overrides.css
   Theme-aware styles for Chat.jsx components and the unified Lab Orders table.
   Uses CSS variables with light/dark fallbacks. Keep this file imported in Chat.jsx.
*/

/* =========================
   THEME VARIABLES
   ========================= */
:root {
  --bg: #ffffff;
  --bg-soft: #f8fafc;
  --bg-elev: #ffffff;
  --text: #0f172a;
  --text-dim: #475569;
  --border: rgba(0,0,0,0.10);
  --shadow: 0 8px 28px rgba(0,0,0,0.10);

  --primary: #0a66c2;
  --primary-contrast: #ffffff;

  --chip-green: #16a34a;
  --chip-yellow: #ca8a04;
  --chip-red: #dc2626;

  --donut-fill: #3750D8;
  --donut-track: #E5E7EB;
  --donut-text: #111827;

  /* Labs prompt */
  --labs-prompt-bg: #eef6ff;
  --labs-prompt-border: rgba(10,102,194,.25);

  /* Cards */
  --card-bg: rgba(255,255,255,0.96);
  --card-border: rgba(0,0,0,0.08);

  /* Table */
  --table-head-bg: #eef3ff;
  --table-row-hover: #fbfcff;

  /* Collapsible */
  --collapsible-bg: #ffffff;

  /* Visual bars */
  --seg-green: #22c55e;
  --seg-yellow: #f59e0b;
  --seg-red: #ef4444;
  --seg-track: #e5e7eb;

  /* Chips */
  --chip-bg: #f1f5f9;
  --chip-border: rgba(0,0,0,0.08);
}

/* Optional explicit dark class hook: <body data-theme="dark"> */
@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0b1220;
    --bg-soft: #0f172a;
    --bg-elev: #111827;
    --text: #e5e7eb;
    --text-dim: #94a3b8;
    --border: rgba(255,255,255,0.12);
    --shadow: 0 8px 28px rgba(0,0,0,0.35);

    --donut-fill: #8ab4ff;
    --donut-track: #273449;
    --donut-text: #e5e7eb;

    --labs-prompt-bg: #0d223a;
    --labs-prompt-border: rgba(138,180,255,.25);

    --card-bg: rgba(22,27,34,0.9);
    --card-border: rgba(255,255,255,0.10);

    --table-head-bg: #0e2139;
    --table-row-hover: rgba(255,255,255,0.04);

    --collapsible-bg: #0f172a;

    --seg-green: #22c55e;
    --seg-yellow: #f59e0b;
    --seg-red: #ef4444;
    --seg-track: #1f2937;

    --chip-bg: rgba(255,255,255,0.05);
    --chip-border: rgba(255,255,255,0.10);
  }
}

[data-theme="dark"] {
  --bg: #0b1220;
  --bg-soft: #0f172a;
  --bg-elev: #111827;
  --text: #e5e7eb;
  --text-dim: #94a3b8;
  --border: rgba(255,255,255,0.12);
  --shadow: 0 8px 28px rgba(0,0,0,0.35);

  --donut-fill: #8ab4ff;
  --donut-track: #273449;
  --donut-text: #e5e7eb;

  --labs-prompt-bg: #0d223a;
  --labs-prompt-border: rgba(138,180,255,.25);

  --card-bg: rgba(22,27,34,0.9);
  --card-border: rgba(255,255,255,0.10);

  --table-head-bg: #0e2139;
  --table-row-hover: rgba(255,255,255,0.04);

  --collapsible-bg: #0f172a;

  --seg-green: #22c55e;
  --seg-yellow: #f59e0b;
  --seg-red: #ef4444;
  --seg-track: #1f2937;

  --chip-bg: rgba(255,255,255,0.05);
  --chip-border: rgba(255,255,255,0.10);
}

/* =========================
   DRAWER / TOOLS GRID
   ========================= */
.tools-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  column-gap: 16px;
  row-gap: 16px;
  align-items: start;
  justify-items: center;
  padding: 16px;
  background: var(--bg-elev);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow);
  z-index: 100000 !important;
 
}

.tool-wrapper {
  display: flex;
  justify-content: center;
  align-items: stretch;
  width: 100%;
}

.drawer-toggle-btn {
  appearance: none;
  border: 1px solid var(--border);
  background: var(--bg-elev);
  color: var(--text);
  border-radius: 12px;
  padding: 10px 12px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: var(--shadow);
}
.drawer-toggle-btn:hover {
  transform: translateY(-1px);
}

/* Normalize fixed pieces in drawer to behave like tiles */
.tool-wrapper > *:first-child,
.tool-wrapper .record-case-btn-left,
.tool-wrapper .record-timer-fixed,
.tool-wrapper .labs-uploader-fixed,
.tool-wrapper .meds-uploader-fixed {
  position: relative !important;
  left: auto !important;
  bottom: auto !important;
  transform: none !important;
  margin: 0 auto !important;
  z-index: 1 !important;
  width: 100% !important;
  max-width: 220px;
}

.labs-prompt {
  width: 100%;
  margin: 0 0 8px 0;
}

/* =========================
   SECOND OPINION
   ========================= */
.so-card {
  border: 1px solid var(--card-border);
  border-radius: 16px;
  background: var(--card-bg);
  box-shadow: var(--shadow);
  padding: 16px;
  color: var(--text);
}
.so-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 14px;
}
.so-title {
  font-weight: 800;
  font-size: 18px;
}
.so-sub {
  font-size: 13px;
  color: var(--text-dim);
}
.so-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 999px;
  background: rgba(55,80,216,0.12);
  border: 1px solid rgba(55,80,216,0.30);
  font-size: 12px;
  font-weight: 700;
}

.so-section {
  border: 1px dashed var(--border);
  border-radius: 12px;
  padding: 12px;
  background: var(--bg-elev);
}
.so-sec-title {
  font-weight: 800;
  font-size: 14px;
  margin-bottom: 8px;
}
.so-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 12px;
}

/* Differential items with bigger donuts */
.so-diffs {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 12px;
}
.so-diff-item {
  display: flex;
  align-items: center;
  gap: 14px;
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 10px;
  background: var(--bg-elev);
}
.so-diff-meta {
  display: grid;
  gap: 4px;
}
.so-diff-name {
  font-weight: 800;
  font-size: 14px;
}
.so-diff-sub {
  font-size: 12px;
  color: var(--text-dim);
}

.so-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
  color: var(--text);
}
.so-table th,
.so-table td {
  border-bottom: 1px solid var(--border);
  padding: 8px 6px;
  text-align: left;
}
.so-narrative {
  border: 1px solid var(--border);
  background: var(--bg-elev);
  border-radius: 12px;
  padding: 12px;
}

/* Recommended labs list with inline Add buttons */
.lab-rec-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 6px 8px;
  border-radius: 10px;
}
.lab-rec-item:hover {
  background: var(--bg-soft);
}
.add-lab-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  padding: 6px 10px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--bg-elev);
  color: var(--text);
  font-weight: 700;
  font-size: 12.5px;
}
.add-lab-btn:hover {
  transform: translateY(-1px);
}

/* =========================
   UNIFIED LAB ORDERS TABLE
   ========================= */
.lab-orders-card {
  border: 1px solid var(--card-border);
  border-radius: 16px;
  background: var(--card-bg);
  box-shadow: var(--shadow);
  overflow: hidden;
  color: var(--text);
}
.lab-orders-header {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 800;
  padding: 12px 14px;
  font-size: 15px;
  background: var(--table-head-bg);
  border-bottom: 1px solid var(--border);
}
.lab-orders-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 14px;
}
.lab-orders-table thead th {
  background: var(--table-head-bg);
  color: var(--text);
  font-weight: 700;
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
}
.lab-orders-table tbody td {
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
  color: var(--text);
}
.lab-orders-table tbody tr {
  transition: background .15s ease, transform .15s ease;
}
.lab-orders-table tbody tr:hover {
  background: var(--table-row-hover);
}

/* priority pills */
.prio-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 56px;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
}
.prio-high { background: #fee2e2; color: #b91c1c; }
.prio-medium { background: #fef9c3; color: #a16207; }
.prio-low { background: #dcfce7; color: #15803d; }

/* send button area */
.send-lab-wrap {
  display: flex;
  justify-content: flex-end;
  padding: 12px 14px;
}
.send-lab-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border: 0;
  cursor: pointer;
  padding: 10px 14px;
  border-radius: 10px;
  background: var(--primary);
  color: var(--primary-contrast);
  font-weight: 800;
  box-shadow: 0 5px 16px rgba(10,102,194,.25);
}
.send-lab-btn:disabled {
  opacity: .6;
  cursor: not-allowed;
  box-shadow: none;
}

/* =========================
   REQUIRED LABS (legacy badge set)
   (kept for compatibility; currently not rendered)
   ========================= */
.req-labs {
  border: 1px solid var(--card-border);
  border-radius: 14px;
  background: var(--card-bg);
  padding: 12px;
}
.req-labs .title {
  font-weight: 800;
  margin-bottom: 8px;
}
.req-chip {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 12px;
  border: 1px solid var(--chip-border);
  margin: 4px 6px 0 0;
  background: var(--chip-bg);
  font-size: 12.5px;
  color: var(--text);
}
.req-chip .why {
  opacity: .8;
  font-size: 11.5px;
}

/* =========================
   LABS VISUAL SUMMARY PANEL
   ========================= */
.labs-panel {
  border: 1px solid var(--card-border);
  border-radius: 16px;
  background: var(--card-bg);
  box-shadow: var(--shadow);
  overflow: hidden;
  color: var(--text);
}
.labs-panel__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
  background: var(--bg-elev);
}
.labs-panel__title {
  font-weight: 800;
  font-size: 15px;
}
.labs-panel__meta {
  font-size: 12px;
  color: var(--text-dim);
}
.labs-panel__legend {
  display: inline-grid;
  grid-auto-flow: column;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text-dim);
}
.chip {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 2px;
  background: var(--seg-track);
}
.chip--green { background: var(--seg-green); }
.chip--yellow { background: var(--seg-yellow); }
.chip--red { background: var(--seg-red); }
.chip--dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--text);
}

.labs-panel__body {
  padding: 8px 12px 12px 12px;
}

/* Rows */
.lab-row {
  display: grid;
  grid-template-columns: minmax(160px, 1fr) 3fr auto;
  gap: 12px;
  align-items: center;
  padding: 10px 8px;
  border-radius: 10px;
}
.lab-row:hover {
  background: var(--bg-soft);
}
.lab-row__left {
  display: grid;
  gap: 3px;
}
.lab-row__name {
  font-weight: 700;
}
.lab-row__range {
  font-size: 12px;
  color: var(--text-dim);
}

.lab-row__bar .range-label {
  font-size: 10px;
  color: var(--text-dim);
  margin-bottom: 6px;
  letter-spacing: .04em;
}
.lab-row__bar .bar {
  position: relative;
  display: flex;
  height: 8px;
  border-radius: 999px;
  background: var(--seg-track);
  overflow: hidden;
}
.lab-row__bar .seg { height: 100%; }
.seg--green { background: var(--seg-green); }
.seg--yellow { background: var(--seg-yellow); }
.seg--red { background: var(--seg-red); }
.lab-row__bar .indicator {
  position: absolute;
  top: -4px;
  width: 2px;
  height: 16px;
  background: currentColor;
  color: var(--text);
  border-radius: 2px;
  transform: translateX(-1px);
}

.lab-row__value {
  font-weight: 800;
  padding: 6px 10px;
  border-radius: 8px;
  justify-self: end;
}
.lab-row__value--normal {
  color: var(--chip-green);
  background: color-mix(in oklab, var(--chip-green) 15%, transparent);
}
.lab-row__value--borderline {
  color: var(--chip-yellow);
  background: color-mix(in oklab, var(--chip-yellow) 18%, transparent);
}
.lab-row__value--abnormal {
  color: var(--chip-red);
  background: color-mix(in oklab, var(--chip-red) 15%, transparent);
}

/* =========================
   LAB AGENT TRIGGER
   ========================= */
.lab-agent-open-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  gap: 8px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--bg-elev);
  color: var(--text);
  font-weight: 800;
  cursor: pointer;
  box-shadow: var(--shadow);
}
.lab-agent-open-btn:hover {
  transform: translateY(-1px);
}


/* =========================
   COLLAPSIBLE DIAGRAM
   ========================= */
.collapsible-diagram {
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--collapsible-bg);
  overflow: hidden;
}
.collapsible-header {
  font-weight: 700;
  padding: 10px 12px;
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  gap: 8px;
  border-bottom: 1px solid var(--border);
}
.collapsible-header:hover {
  background: var(--bg-soft);
}

/* =========================
   MISC
   ========================= */
.typing-caret {
  display: inline-block;
  width: 8px;
  height: 1em;
  background: var(--text);
  margin-left: 2px;
  animation: caret 1s steps(1) infinite;
}
@keyframes caret {
  50% { opacity: 0; }
}

/* Chat layout helpers (non-invasive; complements chat.css) */
.chat-layout {
  background: var(--bg);
  color: var(--text);
}

.avatar img {
  border-radius: 50%;
  border: 1px solid var(--border);
}
/* =========================================================
   LAB ORDERS — PROPORTIONAL WIDTH, NO HORIZONTAL SCROLL
   (Append at the end of chat-overrides.css)
   ========================================================= */

/* Let message bubbles accommodate the wider card */
.chat-content .chat-message .message-text {
  max-width: 100%;
}

/* Card spans wider but stays proportional and centered */
.chat-content .chat-message .message-text > .lab-orders-card {
  width: 100%;
  max-width: 960px;        /* ⬅️ tuned so it’s wider but not huge */
  margin: 8px auto 14px;
}

/* Card chrome */
.lab-orders-card {
  border: 1px solid var(--card-border);
  border-radius: 16px;
  background: var(--card-bg);
  box-shadow: var(--shadow);
  overflow: hidden;        /* ⬅️ no internal scrollbars */
}

/* Header */
.lab-orders-header {
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 900;
  padding: 12px 16px;
  font-size: 15px;
  background: var(--table-head-bg);
  border-bottom: 1px solid var(--border);
}

/* Table: full width, auto layout (no forced min-width) */
.lab-orders-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  table-layout: auto;      /* ⬅️ columns size naturally */
  font-size: 14.5px;
}

/* Header cells (no sticky, no scroll needed) */
.lab-orders-table thead th {
  background: var(--table-head-bg);
  color: var(--text);
  font-weight: 800;
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
}

/* Column sizing — gentle guidance; overrides inline widths */
.lab-orders-table thead th:nth-child(1) { width: 45% !important; } /* Test name */
.lab-orders-table thead th:nth-child(2) { width: 18% !important; } /* Priority */
.lab-orders-table thead th:nth-child(3) { width: auto !important; }/* Reason */

/* Body cells */
.lab-orders-table tbody td {
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
  color: var(--text);
  vertical-align: top;
  word-wrap: break-word;
  overflow-wrap: anywhere;
}

/* Emphasize test names, soften reasons */
.lab-orders-table tbody td:nth-child(1) { font-weight: 800; }
.lab-orders-table tbody td:nth-child(3) { color: var(--text-dim); }

/* Zebra + hover (subtle) */
.lab-orders-table tbody tr:nth-child(even) {
  background: color-mix(in srgb, var(--table-row-hover) 55%, transparent);
}
.lab-orders-table tbody tr:hover {
  background: color-mix(in srgb, var(--table-row-hover) 85%, transparent);
}

/* Priority pills — balanced scale for the new width */
.prio-pill {
  min-width: 60px;
  padding: 5px 11px;
  border-radius: 999px;
  font-size: 12.5px;
  font-weight: 800;
}

/* Footer action area */
.send-lab-wrap {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 12px 14px;
  border-top: 1px solid var(--border);
  background: color-mix(in srgb, var(--bg-elev) 90%, transparent);
}

.send-lab-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border: 0;
  cursor: pointer;
  padding: 11px 15px;
  border-radius: 12px;
  background: var(--primary);
  color: var(--primary-contrast);
  font-weight: 900;
  box-shadow: 0 6px 18px rgba(10,102,194,.22);
}

/* Ensure bot bubble never clips the wider card */
.chat-content .chat-message.bot .message-text {
  width: 100%;
}
/* =========================================================
   ZEBRA EFFECT — clear, balanced striping for lower sections
   Append at the end of chat-overrides.css
   ========================================================= */

/* 1) Lab Orders Table — clear zebra stripes */
.lab-orders-table tbody tr:nth-child(odd) {
  background: color-mix(in srgb, var(--table-row-hover) 86%, transparent);
}
.lab-orders-table tbody tr:nth-child(even) {
  background: color-mix(in srgb, var(--table-row-hover) 58%, transparent);
}
/* Slightly stronger on hover */
.lab-orders-table tbody tr:hover {
  background: color-mix(in srgb, var(--table-row-hover) 95%, transparent);
}

/* Optional dark-mode tuning (keeps stripes visible but softer) */
@media (prefers-color-scheme: dark) {
  .lab-orders-table tbody tr:nth-child(odd) {
    background: color-mix(in srgb, var(--table-row-hover) 70%, transparent);
  }
  .lab-orders-table tbody tr:nth-child(even) {
    background: color-mix(in srgb, var(--table-row-hover) 50%, transparent);
  }
  .lab-orders-table tbody tr:hover {
    background: color-mix(in srgb, var(--table-row-hover) 82%, transparent);
  }
}

/* 2) Second Opinion — ICD-10 table with zebra */
.so-table tbody tr:nth-child(odd) {
  background: color-mix(in srgb, var(--table-row-hover) 80%, transparent);
}
.so-table tbody tr:nth-child(even) {
  background: color-mix(in srgb, var(--table-row-hover) 55%, transparent);
}
.so-table tbody tr:hover {
  background: color-mix(in srgb, var(--table-row-hover) 92%, transparent);
}

/* 3) Labs Summary Panel — value rows with zebra */
.labs-panel__body .lab-row:nth-child(odd) {
  background: color-mix(in srgb, var(--bg-soft) 85%, transparent);
}
.labs-panel__body .lab-row:nth-child(even) {
  background: color-mix(in srgb, var(--bg-soft) 60%, transparent);
}
/* Subtle hover */
.labs-panel__body .lab-row:hover {
  background: color-mix(in srgb, var(--bg-soft) 95%, transparent);
}

/* Light separators that pair nicely with zebra */
.lab-orders-table tbody td,
.so-table tbody td {
  border-bottom: 1px solid var(--border);
}

/* Prevent horizontal scrolling due to zebra overlays */
.lab-orders-card,
.so-card,
.labs-panel {
  overflow-x: hidden;
}
/* =========================================
   RADIAL MENU STYLES (Bottom-Center)
   ========================================= */

/* 1. THEME VARIABLES */
:root {
  --primary: #0a66c2;
  --primary-hover: #0d7afc;
  
  --radial-bg: rgba(255, 255, 255, 0.9);
  --radial-text: #111;
  --radial-bg-glass: rgba(255, 255, 255, 0.75);
  --radial-border: 1px solid rgba(0,0,0,.08);
  --radial-shadow-sm: 0 4px 12px rgba(0,0,0,.1);
  --radial-shadow-md: 0 10px 28px rgba(0,0,0,.18);
  --radial-shadow-lg: 0 32px 72px rgba(0,0,0,.22);
}

[data-theme="dark"] {
  --radial-bg: rgba(25, 25, 25, 0.9);
  --radial-text: #eee;
  --radial-bg-glass: rgba(30, 30, 30, 0.75);
  --radial-border: 1px solid rgba(255,255,255,.12);
  --radial-shadow-sm: 0 4px 12px rgba(0,0,0,.2);
  --radial-shadow-md: 0 10px 28px rgba(0,0,0,.3);
  --radial-shadow-lg: 0 32px 72px rgba(0,0,0,.35);
}


/* 2. ROOT CONTAINER & LAUNCHER
   ========================================= */

/* This is the main fixed container for the entire component */
.radial-root {
  --radius: 150px;   /* distance from center to items */
  --btn: 62px;       /* center button size */
  --item: 54px;      /* item button size */
  --launcher-offset: 20px;
  --open-lift: 100px; /* How high the wheel lifts from bottom */

  position: fixed;
  left: 50%;
  bottom: var(--launcher-offset);
  transform: translateX(-50%);
  
  width: calc(var(--radius) * 2 + var(--item));
  height: calc(var(--radius) * 2 + var(--item));
  display: grid;
  place-items: center;
  z-index: 100;
  
  /* Only interactive when open */
  pointer-events: none;
  transition: bottom .25s ease-out;
}
.radial-root.open {
  bottom: var(--open-lift);
  pointer-events: auto;
}

/* Center launcher button (always visible) */
.radial-toggle {
  width: var(--btn);
  height: var(--btn);
  border-radius: 999px;
  border: none;
  background: var(--radial-bg);
  color: var(--radial-text);
  display: grid;
  place-items: center;
  font-size: 24px;
  box-shadow: var(--radial-shadow-md);
  cursor: pointer;
  pointer-events: auto; /* Always interactive */
  z-index: 102; /* Above face/rotor */
  transition: transform .16s ease, box-shadow .2s ease, background .2s ease;
}
.radial-toggle:hover { 
  transform: scale(1.05);
  background: var(--primary);
  color: #fff;
}
.radial-toggle:active { transform: scale(.97); }

/* Pulse animation when closed */
.radial-root:not(.open) .radial-toggle {
  background: var(--primary);
  color: #fff;
  animation: pulse-radial 2s infinite cubic-bezier(0.4, 0, 0.6, 1);
}

@keyframes pulse-radial {
  0%, 100% {
    box-shadow: 0 0 0 0 color-mix(in srgb, var(--primary) 40%, transparent);
  }
  50% {
    box-shadow: 0 0 0 12px color-mix(in srgb, var(--primary) 0%, transparent);
  }
}


/* 3. RADIAL WHEEL (Animates in/out)
   ========================================= */

/* Container for face + rotor, animates in/out */
.radial-face-container {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
}

/* Face (wedge + ticks) — doesn't rotate */
.radial-face {
  position: absolute;
  width: calc(var(--radius) * 2);
  height: calc(var(--radius) * 2);
  border-radius: 50%;
  box-shadow: inset 0 0 0 14px rgba(0,0,0,.03), var(--radial-shadow-md);
  background: var(--radial-bg);
  backdrop-filter: blur(10px);
  pointer-events: none;
}

/* Ticks behind items */
.radial-ticks {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  mask: radial-gradient(circle at center, black 65%, transparent 66%);
  background: repeating-conic-gradient(from 0deg, var(--radial-text) 0 0.5deg, transparent 0.5deg 12deg);
  opacity: 0.15;
}

/* Hover/selected wedge */
.radial-wedge {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: conic-gradient(
    from var(--sector-start, 0deg),
    color-mix(in srgb, var(--primary) 25%, transparent) 0 var(--sector-sweep, 60deg),
    transparent var(--sector-sweep, 60deg) 360deg
  );
  mask: radial-gradient(circle at center, transparent 0 18%, black 19% 100%);
  pointer-events: none;
  transition: background 0.1s ease;
}

/* Rotor (rotates with wheel) */
.radial-rotor {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  transition: transform .25s cubic-bezier(.2,.8,.25,1);
}

.radial-inner-disc {
  width: calc(var(--radius) * 1.1);
  height: calc(var(--radius) * 1.1);
  border-radius: 50%;
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--radial-text) 5%, transparent);
  background: radial-gradient(
    circle at 50% 50%, 
    color-mix(in srgb, var(--radial-text) 2%, transparent), 
    color-mix(in srgb, var(--radial-text) 4%, transparent) 60%, 
    transparent 61%
  );
  pointer-events: none;
}

/* Item placement on the wheel */
.radial-item {
  --angle: 0deg;
  position: absolute;
  left: 50%;
  top: 50%;
  width: var(--item);
  height: var(--item);
  margin-left: calc(var(--item) / -2);
  margin-top: calc(var(--item) / -2);
  border-radius: 50%;
  border: 0;
  background: var(--radial-bg);
  color: var(--radial-text);
  box-shadow: var(--radial-shadow-md);
  cursor: pointer;
  /* 'opacity' and 'transform' handled by framer-motion */
}
.radial-item:hover {
  transform: rotate(var(--angle)) translateX(var(--radius)) scale(1.08) !important;
  background: var(--primary);
  color: #fff;
  z-index: 10;
}

/* Keep icon/text upright */
.radial-item-inner {
  display: grid;
  place-items: center;
  gap: 2px;
  width: 100%;
  height: 100%;
  /* Counter-rotation handled by framer-motion's parent */
}
.radial-item:hover .radial-item-inner {
  color: #fff !important;
}

.radial-item-icon { 
  font-size: 16px; 
}

.radial-item-label {
  position: absolute;
  top: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 700;
  background: color-mix(in srgb, var(--radial-text) 80%, transparent);
  color: var(--radial-bg);
  white-space: nowrap;
  opacity: 0;
  transition: opacity .2s ease, transform .2s ease;
  pointer-events: none;
}
.radial-item:hover .radial-item-label {
  opacity: 1;
  transform: translateX(-50%) translateY(-2px);
}


/* 4. TOOL PANEL (Fixed Position)
   ========================================= */
.radial-panel {
  position: fixed;
  left: var(--launcher-offset);
  bottom: var(--launcher-offset); /* Sits at bottom-left */
  width: min(90vw, 380px);
  max-height: min(70vh, 640px);
  display: flex;
  flex-direction: column;
  background: var(--radial-bg);
  color: var(--radial-text);
  border-radius: 14px;
  border: var(--radial-border);
  box-shadow: var(--radial-shadow-lg);
  overflow: hidden;
  z-index: 101; /* Above root, below toggle */
  backdrop-filter: blur(12px);
}
.radial-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  font-weight: 700;
  background: color-mix(in srgb, var(--primary) 10%, transparent);
  border-bottom: var(--radial-border);
  gap: 8px;
}
.radial-panel-title {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: var(--primary);
}
.radial-panel-title > span {
  color: var(--radial-text);
}

.radial-panel-close {
  border: 0;
  background: transparent;
  cursor: pointer;
  color: var(--radial-text);
  opacity: 0.7;
  width: 32px;
  height: 32px;
  border-radius: 8px;
  display: grid;
  place-items: center;
  transition: all 0.2s ease;
}
.radial-panel-close:hover { 
  background: color-mix(in srgb, var(--radial-text) 10%, transparent);
  opacity: 1;
}
.radial-panel-body { 
  padding: 12px;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Position & sizing */
.radial-root {
  --size: 320px;
  --radius: 120px;
  position: fixed;
  left: 50%;
  bottom: 18px;               /* closed position */
  transform: translateX(-50%);
  z-index: 999;
  pointer-events: auto;
}

.radial-root.open {
  bottom: 140px;              /* shift up when open */
}

/* Launcher */
.radial-toggle {
  width: 64px;
  height: 64px;
  border-radius: 999px;
  border: 1px solid var(--card-border, rgba(0,0,0,0.12));
  background: var(--card-bg, rgba(255,255,255,0.85));
  backdrop-filter: blur(6px);
  box-shadow: 0 8px 22px rgba(0,0,0,0.18);
  cursor: pointer;
  font-size: 22px;
  display: grid;
  place-items: center;
}

/* Face container */
.radial-face-container {
  position: absolute;
  left: 50%;
  bottom: 48px;
  transform: translateX(-50%);
  width: var(--size);
  height: var(--size);
  pointer-events: none; /* rotor has the click targets */
}

/* Face (wedge highlight + tick ring) */
.radial-face {
  position: absolute;
  inset: 0;
  border-radius: 999px;
  background:
    conic-gradient(
      from var(--sector-start, 0deg),
      color-mix(in oklab, var(--accent, #6366f1), transparent 65%) 0deg,
      color-mix(in oklab, var(--accent, #6366f1), transparent 65%) var(--sector-sweep, 0deg),
      transparent var(--sector-sweep, 0deg)
    );
  mask:
    radial-gradient(circle at center, rgba(0,0,0,1) 62%, rgba(0,0,0,0) 63%);
  opacity: 0.7;
}

.radial-ticks {
  position: absolute;
  inset: 0;
  border-radius: 999px;
  box-shadow: inset 0 0 0 1px var(--card-border, rgba(0,0,0,0.12));
}

/* Rotor with items */
.radial-rotor {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  pointer-events: none;
}

.radial-inner-disc {
  width: 110px;
  height: 110px;
  border-radius: 999px;
  background: var(--card-bg, rgba(255,255,255,0.8));
  backdrop-filter: blur(4px);
  border: 1px solid var(--card-border, rgba(0,0,0,0.12));
  box-shadow: 0 10px 24px rgba(0,0,0,0.15);
}

.radial-item {
  --angle: 0deg;
  position: absolute;
  left: 50%;
  top: 50%;
  transform-origin: center;
  translate: -50% -50%;
  pointer-events: auto;
  border: none;
  background: transparent;
  cursor: pointer;
}

.radial-item-inner {
  display: grid;
  place-items: center;
  width: 84px;
  height: 84px;
  border-radius: 14px;
  border: 1px solid var(--card-border, rgba(0,0,0,0.1));
  background: var(--panel-bg, rgba(255,255,255,0.9));
  backdrop-filter: blur(6px);
  box-shadow: 0 10px 24px rgba(0,0,0,0.15);
  transform: rotate(calc(var(--angle) * -1));
  user-select: none;
}

.radial-item-icon {
  font-size: 20px;
  line-height: 1;
}

.radial-item-label {
  margin-top: 6px;
  font-size: 12px;
  opacity: 0.8;
}

/* Hidden host so tiles remain mountable but invisible */
.tool-host-hidden {
  position: fixed;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  z-index: -1;
}

/* Ensure any internal tiles we mounted don’t claim layout */
.tool-host-hidden .tool-host-tile,
.tool-host-hidden .vision-tool,
.tool-host-hidden .left-rail-actions {
  display: contents; /* keep DOM for programmatic clicks/refs */
}

